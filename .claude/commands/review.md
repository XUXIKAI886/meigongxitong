# 代码审查命令

请对指定的代码进行全面审查，重点关注以下方面：

## 审查要点

### 1. 架构与设计合规性
- ✅ 文件规模是否≤200行（TypeScript/JavaScript文件）
- ✅ 目录文件数是否≤8个
- ✅ 是否正确实现双环境适配（本地/Vercel）
- ✅ API路由是否使用 `getClientIdentifier()` 获取客户端标识
- ✅ 异步任务是否传入 `clientIp` 参数

### 2. 代码质量
- 🔍 是否有明显的代码坏味道（重复代码、过长函数、复杂嵌套）
- 🔍 是否遵循 TypeScript 严格模式
- 🔍 变量和函数命名是否清晰（组件PascalCase，文件kebab-case）
- 🔍 是否有中文注释说明关键逻辑
- 🔍 错误处理是否完善

### 3. 性能与安全
- ⚡ 是否有性能问题（不必要的重渲染、内存泄漏）
- ⚡ 图片上传是否实现客户端压缩（1920px，85%质量）
- 🔒 是否有安全隐患（路径遍历、SQL注入、XSS）
- 🔒 文件操作是否有路径验证
- 🔒 是否正确处理敏感信息

### 4. 项目特定规范
- 📦 API客户端是否继承自 `BaseApiClient`
- 📦 Gemini客户端是否实现 `convertGeminiResponse()` 方法
- 📦 批量处理是否实现智能重试（3次，2秒间隔）
- 📦 是否支持部分成功（批量场景）
- 📦 作业状态响应是否使用 `data.job` 路径
- 📦 成功状态是否使用 `'succeeded'` 而非 `'completed'`

### 5. UI/UX规范
- 🎨 是否统一使用 `@/components/ui` 导入组件
- 🎨 是否有防重复点击机制（进行中时禁用按钮）
- 🎨 是否有清晰的加载状态反馈
- 🎨 错误提示是否用户友好

## 审查输出格式

请按照以下格式输出审查结果：

### ✅ 符合规范的部分
列出代码中做得好的地方

### ⚠️ 需要改进的问题
按严重程度分类：
- **🔴 严重问题**（必须修复）
- **🟡 重要问题**（建议修复）
- **🟢 优化建议**（可选）

### 💡 具体改进建议
为每个问题提供：
1. 问题描述
2. 问题位置（文件:行号）
3. 具体的改进代码示例
4. 改进后的预期效果

### 📊 代码健康度评分
- 架构合规性：X/10
- 代码质量：X/10
- 性能与安全：X/10
- 用户体验：X/10
- **总体评分：X/10**

## 使用方法

```bash
# 审查单个文件
/review src/app/api/example/route.ts

# 审查整个目录
/review src/app/food-replacement/

# 审查最近修改的文件
/review
```

注意：如果未指定文件路径，将审查最近一次git提交中修改的文件。
